import os
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

# 데이터 저장 폴더 생성
output_dir = "sample_data"
os.makedirs(output_dir, exist_ok=True)

def create_docx(filename, title_text, content_dict):
    doc = Document()
    
    # 제목 스타일
    title = doc.add_heading(title_text, level=0)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    doc.add_paragraph("\n")

    # 본문 스타일 설정
    style = doc.styles['Normal']
    style.font.name = 'Malgun Gothic'  # 폰트 설정
    style.font.size = Pt(11)

    for section, text in content_dict.items():
        # 소제목
        heading = doc.add_heading(section, level=1)
        # 본문
        p = doc.add_paragraph(text)
        p.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
        doc.add_paragraph("\n")
    
    filepath = os.path.join(output_dir, filename)
    doc.save(filepath)
    print(f"✅ 생성 완료: {filepath}")

# ---------------------------------------------------------
# 1. [계약서] 표준 도급 계약서 (지체상금 및 불가항력 조항 포함)
# ---------------------------------------------------------
contract_data = {
    "제1조 (총칙)": "발주처 (주)대한건설(이하 '갑')과 원도급사 (주)한국토건(이하 '을')은 '서울-세종 고속도로 제4공구 건설공사'에 대하여 상호 신뢰를 바탕으로 계약을 체결한다.",
    "제18조 (공기 연장)": "1. 천재지변, 불가항력의 사유 또는 '갑'의 귀책사유로 인하여 공사가 지연될 경우 '을'은 공기 연장을 요청할 수 있다.\n2. '갑'은 '을'의 요청이 타당하다고 인정될 경우 공기 연장과 함께 계약 금액 조정을 승인하여야 한다.",
    "제25조 (설계 변경)": "1. 발주처의 필요에 의한 설계 변경 시 발생하는 추가 비용은 실비 정산하여 계약 금액에 반영한다.\n2. '을'은 설계 변경 지시를 받은 날로부터 14일 이내에 변경 견적서를 제출하여야 한다.",
    "제30조 (지체상금)": "준공 기한 내 공사를 완료하지 못할 경우, 매 지체일수마다 계약금액의 1,000분의 1에 해당하는 금액을 지체상금으로 납부한다."
}
create_docx("1_표준도급계약서_제4공구.docx", "건설공사 표준 도급 계약서", contract_data)

# ---------------------------------------------------------
# 2. [공문서] 공사 중지 명령 (발주처 -> 원도급사)
# ---------------------------------------------------------
official_letter_data = {
    "문서 개요": "- 문서번호: 기술-2024-045\n- 수신: (주)한국토건 현장소장\n- 발신: (주)대한건설 사업단장\n- 일자: 2024. 07. 10.",
    "제목": "장마철 집중 호우 대비 공사 중지 명령",
    "내용": "1. 귀 사의 무궁한 발전을 기원합니다.\n2. 기상청 예보에 따르면 금주 내 300mm 이상의 집중 호우가 예상되는바, 현장 안전 사고 예방을 위해 아래와 같이 공사 중지를 명령합니다.\n   가. 중지 기간: 2024. 07. 11. ~ 2024. 07. 15. (5일간)\n   나. 대상 공종: 토공사 및 비계 작업 전면 중지\n3. 위 기간은 천재지변에 의한 불가항력적 사유이므로 공기 연장 사유에 해당함을 알려드립니다."
}
create_docx("2_수신공문_작업중지명령.docx", "공 문 서", official_letter_data)

# ---------------------------------------------------------
# 3. [회의록] 설계 변경 및 공기 지연 대책 회의
# ---------------------------------------------------------
meeting_data = {
    "회의 개요": "- 일시: 2024년 8월 20일 14:00\n- 참석자: 감리단장 김철수, 현장소장 이영희, 공무팀장 박민수",
    "안건 1. 교량 기초 파일 심도 변경 건": "원도급사: 지질 조사 결과 암반층이 예상보다 깊게 위치하여 파일(Pile) 길이를 15m에서 22m로 연장 시공해야 함. 이에 따른 자재비 3억 원 증액 및 공기 20일 연장이 필요함.\n감리단: 지질 변화는 설계 변경 사유에 해당하므로 실정 보고를 통해 승인하겠음.",
    "안건 2. 레미콘 수급 불안정 대책": "원도급사: 최근 레미콘 운송 노조 파업으로 콘크리트 타설이 10일간 지연됨. 이는 불가항력적 사유이므로 공기 연장 인정 요망.\n감리단: 파업은 사회적 재난에 준하여 검토 가능하나, 구체적인 피해 입증 자료(타설 중단 일지 등)를 제출할 것."
}
create_docx("3_현장회의록_설계변경건.docx", "주간 공정 회의록", meeting_data)

# ---------------------------------------------------------
# 4. [이메일] 클레임 제기 사전 통지
# ---------------------------------------------------------
email_data = {
    "메일 정보": "- 보낸 사람: leepm@hktogan.co.kr (이영희 소장)\n- 받는 사람: kimsuper@koreaeng.com (김철수 감리단장)\n- 날짜: 2024. 09. 01.",
    "제목": "[공문 발송 전 사전 협의] 파일 공사 지연에 따른 클레임 제기 건",
    "본문": "단장님, 안녕하십니까. 한국토건 이영희입니다.\n지난 회의 때 논의되었던 파일 길이 연장 건과 관련하여, 본사 법무팀 검토 결과 해당 사유는 '발주처의 설계서 불일치'에 해당하므로 단순 실비 정산 외에 간접비(현장 관리비)까지 포함된 클레임 청구가 필요하다는 의견을 받았습니다.\n다음 주 공정 회의 때 정식으로 비용 산출 근거를 제출하고자 하오니, 사전에 검토 부탁드립니다.\n첨부파일: 추가 비용 산출 내역서(초안).pdf"
}
create_docx("4_발신이메일_클레임통지.docx", "이메일 송부 내역", email_data)

# ---------------------------------------------------------
# 5. [작업일보] 우천으로 인한 작업 불가 기록
# ---------------------------------------------------------
daily_report_data = {
    "작업 개요": "- 날짜: 2024년 7월 12일 (금)\n- 날씨: 호우 (강수량 85mm)\n- 기온: 24도",
    "금일 작업 내용": "- 계획: 토공사 터파기 및 사토 반출\n- 실적: 우천으로 인한 전면 작업 중지 (0%)",
    "특이 사항": "1. 08:00 안전 조회 후 즉시 해산.\n2. 현장 내 배수로 점검 및 양수기 2대 가동 중.\n3. 집중 호우로 인해 장비(굴착기) 진입로 유실됨. 복구에 3일 소요 예상."
}
create_docx("5_작업일보_우천중지.docx", "공 사 작 업 일 보", daily_report_data)

print("\n🎉 [생성 완료] 5개의 가짜 데이터 파일이 'sample_data' 폴더에 만들어졌습니다!")